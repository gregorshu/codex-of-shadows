import { useMemo } from "react";
import { useAppData } from "@/lib/app-data-context";
import { KeeperLanguage } from "@/types";

const baseTranslations = {
  en: {
    appTagline: "Codex of Shadows",
    appTitle: "AI Keeper Companion",
    settingsAriaLabel: "Settings",

    homeWelcomeTitle: "Welcome",
    homeWelcomeDescription: "Choose a scenario to get started.",
    homePredefinedHeading: "Predefined Scenarios",
    homeUseScenarioButton: "Use this scenario",
    homeCreateHeading: "Create New Scenario",
    homeCreateTitle: "Create a new scenario with the Keeper",
    homeCreateDescription: "Walk through a quick wizard to define era, tone, and setting.",
    homeCreateButton: "Create a new scenario",

    settingsTitle: "Settings",
    settingsSubtitle: "Configure the Keeper language, theme, and LLM connection used across the app.",
    settingsTabGeneral: "General",
    settingsTabKeeperPrompt: "Keeper system prompt",
    settingsGeneralHeading: "General",
    settingsGeneralDescription: "Choose defaults for generated content and UI presentation.",
    settingsLanguageLabel: "App language",
    settingsThemeLabel: "Theme",
    themeOptionDark: "Dark",
    themeOptionLight: "Light",
    themeOptionSystem: "System",
    themeOptionGreen: "Green",
    themeOptionBlue: "Blue",
    themeOptionRed: "Red",
    settingsLLMHeading: "LLM connection",
    settingsLLMDescription: "Provide an OpenAI-compatible endpoint to power the Keeper and scenario builders.",
    settingsModelLabel: "Model",
    settingsBaseUrlLabel: "Base URL",
    settingsApiKeyLabel: "API key",
    settingsTemperatureLabel: "Temperature",
    settingsTopPLabel: "Top P",
    settingsStorageNote: "Settings are stored locally in your browser and used for all future sessions.",
    settingsSaveButton: "Save settings",
    settingsSavedStatus: "Saved",
    settingsKeeperPromptHeading: "Keeper prompt",
    settingsKeeperPromptDescription:
      "Edit the system prompt applied before every Keeper response. Customize it to fit your table.",
    settingsKeeperPromptLabel: "System prompt",
    settingsKeeperPromptNote: "Stored locally and sent with all Keeper LLM calls.",

    investigatorWizardBadge: "Investigator wizard",
    investigatorWizardTitle: "Create your character",
    investigatorWizardStep: "Step {{current}} of {{total}}",
    autoGenerateTitle: "Generate Investigator Automatically",
    autoGenerateDescription: "Let the Keeper pitch a character for you.",
    autoGenerateWorking: "Working...",
    autoGenerateButton: "Generate",
    manualCreateTitle: "Create Manually",
    manualCreateDescription: "Start with an empty sheet and fill it in.",
    manualContinue: "Continue",
    nameLabel: "Name",
    occupationLabel: "Occupation",
    backgroundLabel: "Background",
    personalityTraitsLabel: "Personality Traits",
    addTrait: "+ Add trait",
    skillsSummaryLabel: "Skills summary",
    playerNotesLabel: "Player notes",
    saveInvestigator: "Save investigator",
    scenarioBadge: "Scenario",
    premiseLabel: "Premise",

    scenarioWizardBadge: "Scenario wizard",
    scenarioWizardTitle: "Define your setup",
    scenarioWizardStep: "Step {{current}} of {{total}}",
    chooseEra: "Choose era",
    eraDescription: "Classic Call of Cthulhu moods.",
    chooseTone: "Choose tone",
    toneDescription: "Mood for your one-shot.",
    chooseSetting: "Choose setting",
    settingQuickStart: "Quick start",
    settingProvideYourOwn: "Provide your own",
    settingCustomPlaceholder: "Describe the setting",
    navBack: "Back",
    navNext: "Next",
    generating: "Generating...",
    finishSetup: "Finish setup",
    previewBadge: "Preview",
    premisePreviewLabel: "Premise preview",
    premisePreviewFallback:
      "A moody investigation ripe with secrets. Finish setup to let the Keeper draft a premise for you.",
    scenarioNameTemplate: "{{tone}} in the {{era}}",
    scenarioShortDescription: "An adventure set in {{setting}}.",
    scenarioPremiseFallback: "An eerie mystery unfolds in this setting.",

    scenarioHeader: "Scenario",
    editScenario: "Edit Scenario",
    investigatorHeader: "Investigator",
    editInvestigator: "Edit Investigator",
    startScenarioButton: "Start scenario",

    sessionStateDefault: "Investigation begins.",
    sessionStartLogTitle: "Session started",
    sessionStateLabel: "Session state",

    sessionNotFound: "Session not found.",
    returnHome: "Return home",
    describeNextMove: "Describe your next move...",
    editLast: "Edit last",
    cancelLabel: "Cancel",
    sendLabel: "Send",
    keeperSilentFallback: "The Keeper is silent for a moment.",
    keeperMessageFallback:
      "The rain drums harder on the windowpanes. Somewhere in the house, a floorboard creaks in reply. What do you do?",
    playerRewroteAction: "Player rewrote their previous action; ignore prior choice.",
    rolePlayer: "Player",
    roleKeeper: "Keeper",
    roleSystem: "System",

    era1920s: "1920s",
    eraModernDay: "Modern Day",
    eraGaslight: "Gaslight",
    toneInvestigationHeavy: "Investigation-heavy",
    tonePsychologicalHorror: "Psychological Horror",
    toneSurvival: "Survival",
    tonePulp: "Pulp",
    settingSmallCoastalTown: "Small coastal town",
    settingAbandonedFarmhouse: "Abandoned farmhouse",
    settingUniversityCampus: "University campus",
    settingIndustrialDistrict: "Industrial district",
    settingCustom: "Custom",
  },
} as const;

export type TranslationKey = keyof (typeof baseTranslations)["en"];

export const translations: Record<KeeperLanguage, Record<TranslationKey, string>> = {
  en: baseTranslations.en,
  ru: {
    appTagline: "Хранитель зова Ктулху",
    appTitle: "AI-помощник Хранителя",
    settingsAriaLabel: "Настройки",

    homeWelcomeTitle: "Добро пожаловать",
    homeWelcomeDescription: "Выберите сценарий, чтобы начать.",
    homePredefinedHeading: "Готовые сценарии",
    homeUseScenarioButton: "Использовать этот сценарий",
    homeCreateHeading: "Создать новый сценарий",
    homeCreateTitle: "Создать новый сценарий с Хранителем",
    homeCreateDescription: "Короткий мастер выведет вас через выбор эпохи, тона и сеттинга.",
    homeCreateButton: "Создать новый сценарий",

    settingsTitle: "Настройки",
    settingsSubtitle: "Выберите язык Хранителя и интерфейса, тему и подключение к LLM.",
    settingsTabGeneral: "Общее",
    settingsTabKeeperPrompt: "Системный промпт Хранителя",
    settingsGeneralHeading: "Общее",
    settingsGeneralDescription: "Задайте параметры для контента и отображения интерфейса.",
    settingsLanguageLabel: "Язык приложения",
    settingsThemeLabel: "Тема",
    themeOptionDark: "Темная",
    themeOptionLight: "Светлая",
    themeOptionSystem: "Системная",
    themeOptionGreen: "Зеленая",
    themeOptionBlue: "Синяя",
    themeOptionRed: "Красная",
    settingsLLMHeading: "Подключение к LLM",
    settingsLLMDescription: "Укажите совместимый с OpenAI эндпоинт для работы Хранителя и мастеров сценариев.",
    settingsModelLabel: "Модель",
    settingsBaseUrlLabel: "Базовый URL",
    settingsApiKeyLabel: "API-ключ",
    settingsTemperatureLabel: "Temperature",
    settingsTopPLabel: "Top P",
    settingsStorageNote: "Настройки хранятся локально в браузере и применяются ко всем сессиям.",
    settingsSaveButton: "Сохранить настройки",
    settingsSavedStatus: "Сохранено",
    settingsKeeperPromptHeading: "Промпт Хранителя",
    settingsKeeperPromptDescription:
      "Измените системный промпт, который используется перед каждым ответом Хранителя.",
    settingsKeeperPromptLabel: "Системный промпт",
    settingsKeeperPromptNote: "Хранится локально и отправляется во все запросы к LLM для Хранителя.",

    investigatorWizardBadge: "Мастер следователя",
    investigatorWizardTitle: "Создайте персонажа",
    investigatorWizardStep: "Шаг {{current}} из {{total}}",
    autoGenerateTitle: "Сгенерировать автоматически",
    autoGenerateDescription: "Пусть Хранитель предложит концепт персонажа.",
    autoGenerateWorking: "Работаю...",
    autoGenerateButton: "Сгенерировать",
    manualCreateTitle: "Создать вручную",
    manualCreateDescription: "Начните с пустого листа и заполните его.",
    manualContinue: "Продолжить",
    nameLabel: "Имя",
    occupationLabel: "Род занятий",
    backgroundLabel: "Прошлое",
    personalityTraitsLabel: "Черты характера",
    addTrait: "+ Добавить черту",
    skillsSummaryLabel: "Кратко о навыках",
    playerNotesLabel: "Заметки игрока",
    saveInvestigator: "Сохранить персонажа",
    scenarioBadge: "Сценарий",
    premiseLabel: "Завязка",

    scenarioWizardBadge: "Мастер сценария",
    scenarioWizardTitle: "Определите параметры",
    scenarioWizardStep: "Шаг {{current}} из {{total}}",
    chooseEra: "Выберите эпоху",
    eraDescription: "Классические настроения Call of Cthulhu.",
    chooseTone: "Выберите тон",
    toneDescription: "Настрой для ваншота.",
    chooseSetting: "Выберите сеттинг",
    settingQuickStart: "Быстрый выбор",
    settingProvideYourOwn: "Своя идея",
    settingCustomPlaceholder: "Опишите сеттинг",
    navBack: "Назад",
    navNext: "Далее",
    generating: "Генерация...",
    finishSetup: "Завершить",
    previewBadge: "Предпросмотр",
    premisePreviewLabel: "Предпросмотр завязки",
    premisePreviewFallback:
      "Мрачное расследование, полное тайн. Завершите настройку, и Хранитель придумает завязку.",
    scenarioNameTemplate: "{{tone}} в эпоху {{era}}",
    scenarioShortDescription: "Приключение в сеттинге: {{setting}}.",
    scenarioPremiseFallback: "В этом месте разворачивается жуткая тайна.",

    scenarioHeader: "Сценарий",
    editScenario: "Редактировать сценарий",
    investigatorHeader: "Следователь",
    editInvestigator: "Редактировать персонажа",
    startScenarioButton: "Начать сценарий",

    sessionStateDefault: "Расследование начинается.",
    sessionStartLogTitle: "Сессия началась",
    sessionStateLabel: "Состояние сессии",

    sessionNotFound: "Сессия не найдена.",
    returnHome: "Вернуться домой",
    describeNextMove: "Опишите свое следующее действие...",
    editLast: "Редактировать последнее",
    cancelLabel: "Отмена",
    sendLabel: "Отправить",
    keeperSilentFallback: "Хранитель на мгновение умолкает.",
    keeperMessageFallback:
      "Дождь все сильнее барабанит по стеклам. Где-то в доме в ответ поскрипывает половица. Что вы делаете?",
    playerRewroteAction: "Игрок переписал свое предыдущее действие; игнорируйте прошлый выбор.",
    rolePlayer: "Игрок",
    roleKeeper: "Хранитель",
    roleSystem: "Система",

    era1920s: "1920-е",
    eraModernDay: "Наши дни",
    eraGaslight: "Газлайт",
    toneInvestigationHeavy: "Расследование",
    tonePsychologicalHorror: "Психологический хоррор",
    toneSurvival: "Выживание",
    tonePulp: "Палп",
    settingSmallCoastalTown: "Маленький прибрежный город",
    settingAbandonedFarmhouse: "Заброшенная ферма",
    settingUniversityCampus: "Университетский кампус",
    settingIndustrialDistrict: "Промышленный район",
    settingCustom: "Свое",
  },
  fr: {
    appTagline: "Gardien de l'Appel de Cthulhu",
    appTitle: "Compagnon Gardien IA",
    settingsAriaLabel: "Paramètres",

    homeWelcomeTitle: "Bienvenue",
    homeWelcomeDescription: "Choisissez un scénario pour commencer.",
    homePredefinedHeading: "Scénarios prédéfinis",
    homeUseScenarioButton: "Utiliser ce scénario",
    homeCreateHeading: "Créer un nouveau scénario",
    homeCreateTitle: "Créer un nouveau scénario avec le Gardien",
    homeCreateDescription: "Suivez un assistant rapide pour définir l'époque, le ton et le cadre.",
    homeCreateButton: "Créer un nouveau scénario",

    settingsTitle: "Paramètres",
    settingsSubtitle: "Choisissez le langage du Gardien et de l'interface, le thème et la connexion LLM.",
    settingsTabGeneral: "Général",
    settingsTabKeeperPrompt: "Prompt système du Gardien",
    settingsGeneralHeading: "Général",
    settingsGeneralDescription: "Définissez les valeurs par défaut pour le contenu généré et l'affichage.",
    settingsLanguageLabel: "Langue de l'application",
    settingsThemeLabel: "Thème",
    themeOptionDark: "Sombre",
    themeOptionLight: "Clair",
    themeOptionSystem: "Système",
    themeOptionGreen: "Vert",
    themeOptionBlue: "Bleu",
    themeOptionRed: "Rouge",
    settingsLLMHeading: "Connexion LLM",
    settingsLLMDescription:
      "Fournissez un point de terminaison compatible OpenAI pour alimenter le Gardien et les assistants de scénario.",
    settingsModelLabel: "Modèle",
    settingsBaseUrlLabel: "URL de base",
    settingsApiKeyLabel: "Clé API",
    settingsTemperatureLabel: "Température",
    settingsTopPLabel: "Top P",
    settingsStorageNote:
      "Les paramètres sont stockés localement dans votre navigateur et utilisés pour toutes les sessions futures.",
    settingsSaveButton: "Enregistrer les paramètres",
    settingsSavedStatus: "Enregistré",
    settingsKeeperPromptHeading: "Prompt du Gardien",
    settingsKeeperPromptDescription:
      "Modifiez le prompt système envoyé avant chaque réponse du Gardien.",
    settingsKeeperPromptLabel: "Prompt système",
    settingsKeeperPromptNote: "Stocké localement et envoyé à tous les appels LLM du Gardien.",

    investigatorWizardBadge: "Assistant personnage",
    investigatorWizardTitle: "Créez votre personnage",
    investigatorWizardStep: "Étape {{current}} sur {{total}}",
    autoGenerateTitle: "Générer automatiquement",
    autoGenerateDescription: "Laissez le Gardien proposer un personnage.",
    autoGenerateWorking: "Travail en cours...",
    autoGenerateButton: "Générer",
    manualCreateTitle: "Créer manuellement",
    manualCreateDescription: "Commencez avec une fiche vide et complétez-la.",
    manualContinue: "Continuer",
    nameLabel: "Nom",
    occupationLabel: "Occupation",
    backgroundLabel: "Passé",
    personalityTraitsLabel: "Traits de personnalité",
    addTrait: "+ Ajouter un trait",
    skillsSummaryLabel: "Résumé des compétences",
    playerNotesLabel: "Notes du joueur",
    saveInvestigator: "Enregistrer le personnage",
    scenarioBadge: "Scénario",
    premiseLabel: "Premisse",

    scenarioWizardBadge: "Assistant scénario",
    scenarioWizardTitle: "Définissez votre configuration",
    scenarioWizardStep: "Étape {{current}} sur {{total}}",
    chooseEra: "Choisir l'époque",
    eraDescription: "Ambiances classiques de L'Appel de Cthulhu.",
    chooseTone: "Choisir le ton",
    toneDescription: "Atmosphère de votre one-shot.",
    chooseSetting: "Choisir le cadre",
    settingQuickStart: "Démarrage rapide",
    settingProvideYourOwn: "Proposer le vôtre",
    settingCustomPlaceholder: "Décrivez le cadre",
    navBack: "Retour",
    navNext: "Suivant",
    generating: "Génération...",
    finishSetup: "Terminer",
    previewBadge: "Aperçu",
    premisePreviewLabel: "Aperçu de la premisse",
    premisePreviewFallback:
      "Une enquête sombre pleine de secrets. Terminez la configuration pour laisser le Gardien rédiger une premisse.",
    scenarioNameTemplate: "{{tone}} dans les années {{era}}",
    scenarioShortDescription: "Une aventure située dans {{setting}}.",
    scenarioPremiseFallback: "Un mystère inquiétant se dévoile dans ce cadre.",

    scenarioHeader: "Scénario",
    editScenario: "Modifier le scénario",
    investigatorHeader: "Investigateur",
    editInvestigator: "Modifier le personnage",
    startScenarioButton: "Commencer le scénario",

    sessionStateDefault: "L'enquête commence.",
    sessionStartLogTitle: "Session commencée",
    sessionStateLabel: "État de la session",

    sessionNotFound: "Session introuvable.",
    returnHome: "Retour à l'accueil",
    describeNextMove: "Décrivez votre prochaine action...",
    editLast: "Modifier le dernier",
    cancelLabel: "Annuler",
    sendLabel: "Envoyer",
    keeperSilentFallback: "Le Gardien reste silencieux un instant.",
    keeperMessageFallback:
      "La pluie martèle plus fort les vitres. Quelque part dans la maison, une planche grince en réponse. Que faites-vous ?",
    playerRewroteAction: "Le joueur a réécrit son action précédente ; ignorez le choix précédent.",
    rolePlayer: "Joueur",
    roleKeeper: "Gardien",
    roleSystem: "Système",

    era1920s: "Années 1920",
    eraModernDay: "Époque moderne",
    eraGaslight: "Ère Victorienne",
    toneInvestigationHeavy: "Enquête poussée",
    tonePsychologicalHorror: "Horreur psychologique",
    toneSurvival: "Survie",
    tonePulp: "Pulp",
    settingSmallCoastalTown: "Petite ville côtière",
    settingAbandonedFarmhouse: "Ferme abandonnée",
    settingUniversityCampus: "Campus universitaire",
    settingIndustrialDistrict: "Quartier industriel",
    settingCustom: "Personnalisé",
  },
  es: {
    appTagline: "Guardián de La llamada de Cthulhu",
    appTitle: "Compañero Guardián IA",
    settingsAriaLabel: "Ajustes",

    homeWelcomeTitle: "Bienvenido",
    homeWelcomeDescription: "Elige un escenario para comenzar.",
    homePredefinedHeading: "Escenarios predefinidos",
    homeUseScenarioButton: "Usar este escenario",
    homeCreateHeading: "Crear nuevo escenario",
    homeCreateTitle: "Crea un nuevo escenario con el Guardián",
    homeCreateDescription: "Un asistente rápido te guiará por época, tono y ambientación.",
    homeCreateButton: "Crear un nuevo escenario",

    settingsTitle: "Ajustes",
    settingsSubtitle: "Define el idioma del Guardián y la interfaz, el tema y la conexión LLM.",
    settingsTabGeneral: "General",
    settingsTabKeeperPrompt: "Prompt del Guardián",
    settingsGeneralHeading: "General",
    settingsGeneralDescription: "Elige valores predeterminados para el contenido y la presentación del UI.",
    settingsLanguageLabel: "Idioma de la aplicación",
    settingsThemeLabel: "Tema",
    themeOptionDark: "Oscuro",
    themeOptionLight: "Claro",
    themeOptionSystem: "Sistema",
    themeOptionGreen: "Verde",
    themeOptionBlue: "Azul",
    themeOptionRed: "Rojo",
    settingsLLMHeading: "Conexión LLM",
    settingsLLMDescription:
      "Proporciona un endpoint compatible con OpenAI para el Guardián y los asistentes de escenario.",
    settingsModelLabel: "Modelo",
    settingsBaseUrlLabel: "URL base",
    settingsApiKeyLabel: "Clave API",
    settingsTemperatureLabel: "Temperatura",
    settingsTopPLabel: "Top P",
    settingsStorageNote: "Los ajustes se guardan localmente en tu navegador y se usan en futuras sesiones.",
    settingsSaveButton: "Guardar ajustes",
    settingsSavedStatus: "Guardado",
    settingsKeeperPromptHeading: "Prompt del Guardián",
    settingsKeeperPromptDescription:
      "Edita el prompt del sistema que se envía antes de cada respuesta del Guardián.",
    settingsKeeperPromptLabel: "Prompt del sistema",
    settingsKeeperPromptNote: "Se guarda localmente y se envía en todas las futuras llamadas LLM del Guardián.",

    investigatorWizardBadge: "Asistente de investigador",
    investigatorWizardTitle: "Crea tu personaje",
    investigatorWizardStep: "Paso {{current}} de {{total}}",
    autoGenerateTitle: "Generar automáticamente",
    autoGenerateDescription: "Deja que el Guardián proponga un personaje.",
    autoGenerateWorking: "Trabajando...",
    autoGenerateButton: "Generar",
    manualCreateTitle: "Crear manualmente",
    manualCreateDescription: "Empieza con una hoja vacía y complétala.",
    manualContinue: "Continuar",
    nameLabel: "Nombre",
    occupationLabel: "Ocupación",
    backgroundLabel: "Historia",
    personalityTraitsLabel: "Rasgos de personalidad",
    addTrait: "+ Añadir rasgo",
    skillsSummaryLabel: "Resumen de habilidades",
    playerNotesLabel: "Notas del jugador",
    saveInvestigator: "Guardar personaje",
    scenarioBadge: "Escenario",
    premiseLabel: "Premisa",

    scenarioWizardBadge: "Asistente de escenario",
    scenarioWizardTitle: "Define tu preparación",
    scenarioWizardStep: "Paso {{current}} de {{total}}",
    chooseEra: "Elegir época",
    eraDescription: "Ambientes clásicos de La llamada de Cthulhu.",
    chooseTone: "Elegir tono",
    toneDescription: "Clima para tu one-shot.",
    chooseSetting: "Elegir ambientación",
    settingQuickStart: "Inicio rápido",
    settingProvideYourOwn: "Aporta la tuya",
    settingCustomPlaceholder: "Describe la ambientación",
    navBack: "Atrás",
    navNext: "Siguiente",
    generating: "Generando...",
    finishSetup: "Terminar",
    previewBadge: "Vista previa",
    premisePreviewLabel: "Vista previa de la premisa",
    premisePreviewFallback:
      "Una investigación oscura llena de secretos. Termina la preparación para que el Guardián escriba la premisa.",
    scenarioNameTemplate: "{{tone}} en la época {{era}}",
    scenarioShortDescription: "Una aventura ambientada en {{setting}}.",
    scenarioPremiseFallback: "Un misterio inquietante se desarrolla en este lugar.",

    scenarioHeader: "Escenario",
    editScenario: "Editar escenario",
    investigatorHeader: "Investigador",
    editInvestigator: "Editar personaje",
    startScenarioButton: "Iniciar escenario",

    sessionStateDefault: "Comienza la investigación.",
    sessionStartLogTitle: "Sesión iniciada",
    sessionStateLabel: "Estado de la sesión",

    sessionNotFound: "Sesión no encontrada.",
    returnHome: "Volver al inicio",
    describeNextMove: "Describe tu próxima acción...",
    editLast: "Editar el último",
    cancelLabel: "Cancelar",
    sendLabel: "Enviar",
    keeperSilentFallback: "El Guardián guarda silencio por un momento.",
    keeperMessageFallback:
      "La lluvia golpea más fuerte las ventanas. En alguna parte de la casa cruje una tabla. ¿Qué haces?",
    playerRewroteAction: "El jugador reescribió su acción anterior; ignora la elección previa.",
    rolePlayer: "Jugador",
    roleKeeper: "Guardián",
    roleSystem: "Sistema",

    era1920s: "Años 1920",
    eraModernDay: "Época moderna",
    eraGaslight: "Época victoriana",
    toneInvestigationHeavy: "Enfoque investigativo",
    tonePsychologicalHorror: "Horror psicológico",
    toneSurvival: "Supervivencia",
    tonePulp: "Pulp",
    settingSmallCoastalTown: "Pequeña ciudad costera",
    settingAbandonedFarmhouse: "Granja abandonada",
    settingUniversityCampus: "Campus universitario",
    settingIndustrialDistrict: "Distrito industrial",
    settingCustom: "Personalizado",
  },
};

export const LANGUAGE_NATIVE_NAMES: Record<KeeperLanguage, string> = {
  en: "English",
  ru: "Русский",
  fr: "Français",
  es: "Español",
};

export const LANGUAGE_ENGLISH_NAMES: Record<KeeperLanguage, string> = {
  en: "English",
  ru: "Russian",
  fr: "French",
  es: "Spanish",
};

export function translate(
  language: KeeperLanguage,
  key: TranslationKey,
  params?: Record<string, string | number>
): string {
  const dictionary = translations[language] ?? translations.en;
  const fallback = translations.en;
  const template = dictionary[key] ?? fallback[key] ?? key;

  if (!params) return template;

  return Object.entries(params).reduce(
    (current, [paramKey, value]) => current.replaceAll(`{{${paramKey}}}`, String(value)),
    template
  );
}

export function useTranslation() {
  const { data } = useAppData();
  const language = data.settings.language;

  const t = useMemo(
    () => (key: TranslationKey, params?: Record<string, string | number>) => translate(language, key, params),
    [language]
  );

  return { t, language };
}

export const fallbackInvestigatorByLanguage: Record<
  KeeperLanguage,
  { name: string; occupation: string; background: string; traits: string[]; skills: string }
> = {
  en: {
    name: "Evelyn Hart",
    occupation: "Photojournalist",
    background:
      "A Boston reporter who chases whispers of occult rumors, carrying a camera and scars from seeing too much in war-time Europe.",
    traits: ["Curious", "Guarded", "Calm under pressure"],
    skills: "Sharp eyes, street contacts, careful research, steady with a camera and small arms.",
  },
  ru: {
    name: "Эвелин Харт",
    occupation: "Фотокорреспондент",
    background:
      "Репортёр из Бостона, охотится за слухами об оккультизме, носит камеру и шрамы от того, что видела в военной Европе.",
    traits: ["Любопытная", "Сдержанная", "Хладнокровная"],
    skills: "Острый глаз, уличные контакты, аккуратное расследование, уверенно обращается с камерой и оружием.",
  },
  fr: {
    name: "Evelyn Hart",
    occupation: "Photojournaliste",
    background:
      "Reporter de Boston qui traque les rumeurs occultes, armée d'un appareil photo et de cicatrices de l'Europe en guerre.",
    traits: ["Curieuse", "Méfiant", "Calme sous pression"],
    skills: "Œil aiguisé, contacts dans la rue, recherches appliquées, à l'aise avec l'appareil et une arme légère.",
  },
  es: {
    name: "Evelyn Hart",
    occupation: "Fotoperiodista",
    background:
      "Reportera de Boston que persigue rumores ocultos; lleva una cámara y cicatrices de lo visto en la Europa en guerra.",
    traits: ["Curiosa", "Reservada", "Serena bajo presión"],
    skills: "Buena vista, contactos callejeros, investigación cuidadosa, firme con la cámara y armas ligeras.",
  },
};

